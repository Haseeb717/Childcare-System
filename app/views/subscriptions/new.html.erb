Price: <%= number_to_currency @subscription.plan.price %>
Allocation: <%= @subscription.plan.allocation %>
<%= form_for [@subscription.plan, @subscription], method: :post do |f| %>

    <% if @subscription.errors.any? %>
        <div class="error_messages">
            <h2><%= pluralize(@subscription.errors.count, "error") %> prohibited this subscription from being saved:</h2>
            <ul>
                <% @subscription.errors.full_messages.each do |msg| %>
                <li><%= msg %></li>
                <% end %>
            </ul>
        </div>
    <% end %>
    <%= f.hidden_field :stripe_card_token %>

    <div class="form-group">
        <%= label_tag :card_number, "Credit Card Number" %>
        <%= text_field_tag :card_number, nil, name: nil, :class => 'form-control' %>
    </div>

    <div class="form-group">
        <%= label_tag :card_month, "Card Expiration" %>
        <%= select_month nil, {add_month_numbers: true}, {name: nil, id: "card_month", :class => 'form-control'} %>
        <%= select_year nil, {start_year: Date.today.year, end_year: Date.today.year+15}, {name: nil, id: "card_year", :class => 'form-control'} %>
    </div>

    <div class="form-group">
        <%= label_tag :card_code, "CV Code" %>
        <%= text_field_tag :card_code, nil, name: nil, :class => 'form-control' %>
    </div>
                                
    <div class="form-group">                    
        <%= label_tag :discount_code, 'Promo Code' %>
        <% if current_user.within_first?(100) %>
            <%= text_field_tag :discount_code, "FIRST100", :class => 'form-control', readonly: true %>
        <% else %>
            <%= text_field_tag :discount_code, "", :class => 'form-control' %>
        <% end %>
    </div>

    <div class="form-group">
        <%= f.check_box :terms, checked: false %>
        I accept the Code of Ethics
    </div>
                            
    <%= f.submit "Pay Now" %>

    <div id="stripe_error">
        <noscript>JavaScript is not enabled and is required for this form. First enable it in your web browser settings.</noscript>
    </div>

<% end %>   